## FeesVault Contract Management Guide

This document provides an overview of the `FeesVault` contracts used in conjunction with V2 and V3 liquidity pools, and explains how to configure the distribution of fees between different recipients, such as gauges and other addresses.

### What is a FeesVault?
For every liquidity pool created in V2 or V3 (`Pair` in V2 and `AlgebraPool` in V3), a dedicated `FeesVault` contract is deployed. The `FeesVault` receives swap fees generated by the respective pool. These fees are distributed according to the configured parameters for each vault, which can include allocations to gauges, community funds, or other recipients.

The purpose of `FeesVault` is to facilitate a flexible and transparent fee management mechanism, allowing the redistribution of accrued fees to various recipients based on protocol settings or custom user requirements.

### Default, Creator, and Custom Distribution Configurations

Each `FeesVault` can have a **default distribution configuration**, a **creator-specific distribution configuration**, or a **custom distribution configuration**. The default configuration is set at the factory level and applies to all new and old vaults unless overridden. Creator-specific configurations can be applied based on the address that created the vault, and custom configurations can be set for individual vaults.

The order of priority for fee distribution configurations is as follows:

1. **Custom Distribution Configuration**: This configuration, if set, takes the highest priority for a specific `FeesVault`.
2. **Creator-Specific Distribution Configuration**: If a custom configuration is not set, the configuration defined for the creator of the `FeesVault` is used.
3. **Default Distribution Configuration**: If neither custom nor creator-specific configurations are set, the default configuration is used.

- **Default Distribution**: The `defaultDistributionConfig` parameter is set at the `FeesVaultFactoryUpgradeable` contract level and determines the default split for future pools.
- **Creator-Specific Distribution**: The distribution configuration can be set for a specific creator address, which applies to all `FeesVault` contracts created by that address unless overridden by a custom configuration.
- **Custom Distribution**: Custom configurations can be applied on a per-vault basis using the `setCustomDistributionConfig` function.

### Setting Default Distribution Configuration
To set a default distribution configuration for all future `FeesVault` contracts, use the following function in the `FeesVaultFactoryUpgradeable` contract:

```solidity
    /**
     * @notice Sets a default distribution configuration for a fees vaults.
     * @param config_ The distribution configuration to apply.
     */
    function setDefaultDistributionConfig(DistributionConfig memory config_) external;
```

- **`config_`**: This parameter includes:
  - `toGaugeRate`: The rate at which fees are distributed to the gauge.
  - `recipients`: The addresses of additional recipients for fees.
  - `rates`: The rates at which fees are distributed to each recipient.

### Setting Creator-Specific Distribution Configuration
To set a distribution configuration for a specific creator of `FeesVault` contracts, use the following function:

```solidity
    /**
     * @notice Sets a distribution configuration for a specific creator.
     * @param creator_ The address of the creator of fees vaults.
     * @param config_ The distribution configuration to apply.
     */
    function setDistributionConfigForCreator(address creator_, DistributionConfig memory config_) external;
```

- **`creator_`**: The address of the creator for whom the configuration is being set.
- **`config_`**: The distribution configuration, including `toGaugeRate`, `recipients`, and `rates`.

To clear the creator-specific distribution configuration so that it is no longer used, set 'config_' to have 'toGaugeRate' as 0 and provide empty arrays for 'recipients' and 'rates'.

### Setting Custom Distribution for a Specific FeesVault
To set a custom fee distribution for a specific `FeesVault`, you can use the following function:

```solidity
    /**
     * @notice Sets a custom distribution configuration for a specific fees vault.
     * @param feesVault_ The address of the fees vault to configure.
     * @param config_ The custom distribution configuration to apply.
     */
    function setCustomDistributionConfig(address feesVault_, DistributionConfig memory config_) external;
```

- **`feesVault_`**: The address of the `FeesVault` that you want to configure.
- **`config_`**: The custom distribution configuration to apply, which includes the `toGaugeRate`, `recipients`, and `rates` for distribution.

To clear a custom configuration so that it is no longer used, set `config_` to have `toGaugeRate` as `0` and provide empty arrays for `recipients` and `rates`.